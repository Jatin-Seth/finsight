<%- include('layouts/header') %>

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 60vh; text-align: center; padding: 2rem;">

    <!-- Animated Error Icon -->
    <div style="font-size: 6rem; margin-bottom: 2rem; animation: bounce 2s infinite;" class="fade-in">
        ⚠️
    </div>

    <!-- Error Title -->
    <h1 style="color: #1f2937; margin-bottom: 1rem; font-size: 2.5rem; font-weight: 700;" class="fade-in" style="animation-delay: 0.2s;">
        Oops! Something went wrong
    </h1>

    <!-- Error Message Card -->
    <div class="card fade-in" style="max-width: 600px; margin-bottom: 3rem; animation-delay: 0.4s;">
        <div class="card-body">
            <div style="display: flex; align-items: flex-start; gap: 1rem;">
                <div style="color: #dc2626; margin-top: 0.25rem; font-size: 1.5rem;">🚨</div>
                <div style="text-align: left;">
                    <h3 style="margin: 0 0 0.5rem 0; color: #dc2626; font-size: 1.125rem;">
                        Error Details
                    </h3>
                    <p style="margin: 0; color: #374151; line-height: 1.6;">
                        <%= message || 'An unexpected error occurred. This might be a temporary issue with our servers or a problem with your request.' %>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Troubleshooting Tips -->
    <div class="card fade-in" style="max-width: 800px; margin-bottom: 3rem; animation-delay: 0.6s;">
        <div class="card-header">
            <h3 style="margin: 0; color: #1f2937; display: flex; align-items: center; gap: 0.5rem;">
                🔧 Troubleshooting Steps
            </h3>
        </div>
        <div class="card-body">
            <div class="grid grid-2" style="gap: 2rem;">
                <div>
                    <h4 style="color: #374151; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        🔐 Authentication Issues
                    </h4>
                    <div style="font-size: 0.875rem; color: #6b7280; line-height: 1.6;">
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                            <div style="color: #3b82f6; margin-top: 0.125rem;">1️⃣</div>
                            <div>
                                <strong style="color: #1f2937;">Clear Browser Data:</strong><br>
                                Clear your cookies and cache, then try logging in again
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                            <div style="color: #3b82f6; margin-top: 0.125rem;">2️⃣</div>
                            <div>
                                <strong style="color: #1f2937;">Verify Credentials:</strong><br>
                                Double-check your email and password combination
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                            <div style="color: #3b82f6; margin-top: 0.125rem;">3️⃣</div>
                            <div>
                                <strong style="color: #1f2937;">Session Timeout:</strong><br>
                                Your session may have expired - try logging out and back in
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 style="color: #374151; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        📊 Portfolio Issues
                    </h4>
                    <div style="font-size: 0.875rem; color: #6b7280; line-height: 1.6;">
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                            <div style="color: #22c55e; margin-top: 0.125rem;">✅</div>
                            <div>
                                <strong style="color: #1f2937;">Check Ownership:</strong><br>
                                Make sure the portfolio belongs to your account
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                            <div style="color: #22c55e; margin-top: 0.125rem;">✅</div>
                            <div>
                                <strong style="color: #1f2937;">Refresh Data:</strong><br>
                                Go back to dashboard and try accessing the portfolio again
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                            <div style="color: #22c55e; margin-top: 0.125rem;">✅</div>
                            <div>
                                <strong style="color: #1f2937;">Check Permissions:</strong><br>
                                Ensure you have the necessary permissions to view this data
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div style="display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center; margin-bottom: 2rem;" class="fade-in" style="animation-delay: 0.8s;">
        <button onclick="history.back()" class="btn btn-primary" style="min-width: 160px;">
            ← Go Back
        </button>
        
        <a href="/demo/dashboard" class="btn btn-success" style="min-width: 160px;">
            🏠 Dashboard
        </a>
        
        <a href="/demo/login" class="btn" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; min-width: 160px;">
            🔐 Sign In
        </a>
        
        <button onclick="window.location.reload()" class="btn btn-secondary" style="min-width: 160px;">
            🔄 Refresh Page
        </button>
    </div>

    <!-- Additional Help Section -->
    <div class="card fade-in" style="max-width: 700px; animation-delay: 1s;">
        <div class="card-header" style="background: linear-gradient(135deg, #f8fafc, #f1f5f9);">
            <h4 style="margin: 0; color: #1f2937; display: flex; align-items: center; gap: 0.5rem;">
                💡 Still Need Help?
            </h4>
        </div>
        <div class="card-body">
            <div style="text-align: left; color: #6b7280; line-height: 1.6;">
                <p style="margin-bottom: 1.5rem; font-size: 0.875rem;">
                    If the error persists after trying the troubleshooting steps above, here are some additional solutions:
                </p>
                
                <div style="display: grid; gap: 1rem; font-size: 0.875rem;">
                    <div style="display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: linear-gradient(135deg, #eff6ff, #dbeafe); border-radius: 0.5rem; border: 1px solid #bfdbfe;">
                        <div style="color: #2563eb; margin-top: 0.125rem; font-size: 1.25rem;">🌐</div>
                        <div>
                            <strong style="color: #1e40af;">Browser Issues:</strong><br>
                            <span style="color: #3730a3;">Try using a different browser or disable browser extensions temporarily</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-radius: 0.5rem; border: 1px solid #bbf7d0;">
                        <div style="color: #16a34a; margin-top: 0.125rem; font-size: 1.25rem;">🔧</div>
                        <div>
                            <strong style="color: #15803d;">Technical Issues:</strong><br>
                            <span style="color: #166534;">Check your internet connection and ensure JavaScript is enabled</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; background: linear-gradient(135deg, #fffbeb, #fef3c7); border-radius: 0.5rem; border: 1px solid #fcd34d;">
                        <div style="color: #d97706; margin-top: 0.125rem; font-size: 1.25rem;">⏰</div>
                        <div>
                            <strong style="color: #92400e;">Server Issues:</strong><br>
                            <span style="color: #a16207;">This might be a temporary server issue. Please wait a few minutes and try again</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- Auto-refresh option -->
<div style="position: fixed; bottom: 2rem; right: 2rem; z-index: 1000;" class="fade-in" style="animation-delay: 1.2s;">
    <button id="autoRefreshBtn" class="btn" style="background: linear-gradient(135deg, #6366f1, #4f46e5); color: white; box-shadow: var(--shadow-xl); display: none;">
        🔄 Auto-retry in <span id="countdown">10</span>s
    </button>
</div>

<script>
    // Add bounce animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
    `;
    document.head.appendChild(style);

    // Auto-refresh functionality
    let countdown = 10;
    let autoRefreshTimer;
    
    function startAutoRefresh() {
        const btn = document.getElementById('autoRefreshBtn');
        const countdownSpan = document.getElementById('countdown');
        
        // Show the button after 3 seconds
        setTimeout(() => {
            btn.style.display = 'block';
            btn.style.animation = 'pulse 2s infinite';
        }, 3000);
        
        autoRefreshTimer = setInterval(() => {
            countdown--;
            countdownSpan.textContent = countdown;
            
            if (countdown <= 0) {
                clearInterval(autoRefreshTimer);
                window.location.reload();
            }
        }, 1000);
    }
    
    // Click to refresh immediately
    document.getElementById('autoRefreshBtn').addEventListener('click', () => {
        clearInterval(autoRefreshTimer);
        window.location.reload();
    });
    
    // Start auto-refresh timer
    // Uncomment the line below if you want auto-refresh functionality
    // startAutoRefresh();
    
    // Add smooth interactions to buttons
    document.querySelectorAll('.btn').forEach(btn => {
        btn.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-2px) scale(1.02)';
        });
        
        btn.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
</script>

<%- include('layouts/footer') %>